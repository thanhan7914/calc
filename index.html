<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>T√≠nh to√°n s·ªë l∆∞·ª£ng h√†ng h√≥a</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/3.3.4/vue.global.min.js"></script>
    <link rel="stylesheet" href="main.css" />
  </head>
  <body>
    <div id="app">
      <div class="container">
        <div class="header">
          <h1>üßÆ T√≠nh to√°n s·ªë l∆∞·ª£ng h√†ng h√≥a</h1>
          <p>Nh·∫≠p ƒë∆°n gi√° v√† t·ªïng ti·ªÅn ƒë·ªÉ t√≠nh to√°n s·ªë l∆∞·ª£ng c·∫ßn xu·∫•t</p>
        </div>

        <div class="content">
          <!-- Ph·∫ßn nh·∫≠p t·ªïng ti·ªÅn -->
          <div class="input-section">
            <div class="form-group">
              <label for="totalAmount"
                >üí∞ T·ªïng ti·ªÅn thanh to√°n (ƒë√£ bao g·ªìm VAT):</label
              >
              <input
                type="number"
                id="totalAmount"
                v-model="totalAmount"
                placeholder="V√≠ d·ª•: 4169000"
                min="0"
              />
            </div>

            <div class="form-group">
              <label for="vatRate">üìä Thu·∫ø su·∫•t VAT (%):</label>
              <input
                type="number"
                id="vatRate"
                v-model="vatRate"
                placeholder="V√≠ d·ª•: 10"
                min="0"
                max="100"
              />
            </div>
          </div>

          <!-- Ph·∫ßn danh s√°ch s·∫£n ph·∫©m -->
          <div class="products-section">
            <h2 class="section-title">üì¶ Danh s√°ch m·∫∑t h√†ng</h2>

            <div
              v-for="(product, index) in products"
              :key="index"
              class="product-item"
            >
              <div class="product-row">
                <div class="form-group">
                  <label>T√™n h√†ng h√≥a:</label>
                  <input
                    type="text"
                    v-model="product.name"
                    :placeholder="'S·∫£n ph·∫©m ' + (index + 1)"
                    style="
                      border: 2px solid #e0e6ed;
                      padding: 12px;
                      border-radius: 8px;
                      width: 100%;
                    "
                  />
                </div>
                <div class="form-group">
                  <label>ƒê∆°n gi√° (VNƒê):</label>
                  <input
                    type="number"
                    v-model="product.price"
                    placeholder="Nh·∫≠p ƒë∆°n gi√°"
                    min="0"
                  />
                </div>
                <button
                  @click="removeProduct(index)"
                  class="btn btn-danger"
                  v-if="products.length > 1"
                >
                  üóëÔ∏è X√≥a
                </button>
              </div>
            </div>

            <div id="controls" class="controls">
              <button @click="addProduct" class="btn btn-primary">
                ‚ûï Th√™m m·∫∑t h√†ng
              </button>
              <button @click="calculate" class="btn btn-success">
                üßÆ T√≠nh to√°n s·ªë l∆∞·ª£ng
              </button>
              <button @click="removeAllProducts" class="btn btn-danger">
                üóëÔ∏è X√≥a t·∫•t c·∫£
              </button>
            </div>
          </div>

          <!-- Hi·ªÉn th·ªã k·∫øt qu·∫£ -->
          <div v-if="showResults" id="calculated" class="results">
            <h2 class="results-title">üìã K·∫øt qu·∫£ t√≠nh to√°n</h2>

            <div v-if="errorMessage" class="error">{{ errorMessage }}</div>

            <div v-else-if="successMessage" class="success">
              {{ successMessage }}
            </div>

            <table v-if="calculatedResults.length > 0" class="result-table">
              <thead>
                <tr>
                  <th>STT</th>
                  <th>T√™n h√†ng h√≥a</th>
                  <th>S·ªë l∆∞·ª£ng</th>
                  <th>ƒê∆°n gi√° (VNƒê)</th>
                  <th>Th√†nh ti·ªÅn (VNƒê)</th>
                </tr>
              </thead>
              <tbody>
                <tr v-for="(result, index) in calculatedResults" :key="index">
                  <td>{{ index + 1 }}</td>
                  <td>{{ result.name }}</td>
                  <td>{{ result.quantity }}</td>
                  <td :class="{'adjust': isAdjustLastPrice && index == adjustIndex}">{{ formatNumber(result.price) }}</td>
                  <td>{{ formatNumber(result.subtotal) }}</td>
                </tr>
                <tr class="total-row">
                  <td colspan="4"><strong>T·ªïng c·ªông</strong></td>
                  <td>
                    <strong
                      >{{ formatNumber(calculatedResults.reduce((sum, r) => sum
                      + r.subtotal, 0)) }}</strong
                    >
                  </td>
                </tr>
                <tr class="total-row">
                  <td colspan="4">
                    <strong>Thu·∫ø VAT ({{ vatRate }}%)</strong>
                  </td>
                  <td><strong>{{ formatNumber(vatAmount) }}</strong></td>
                </tr>
                <tr class="total-row">
                  <td colspan="4"><strong>T·ªïng thanh to√°n</strong></td>
                  <td>
                    <strong
                      >{{ formatNumber(totalBeforeVAT + vatAmount) }}</strong
                    >
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
    <script src="finder.js"></script>
    <script src="app.js"></script>
  </body>
</html>
